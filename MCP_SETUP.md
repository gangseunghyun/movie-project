# MCP (Model Context Protocol) AI 챗봇 설정 가이드

## 🚀 MCP란?

**MCP (Model Context Protocol)**는 AI 모델과 도구/데이터베이스 간의 표준화된 통신 프로토콜입니다.

### 특징:
- **구조화된 도구 호출**: 정확한 데이터 검색
- **확장 가능**: 새로운 도구 쉽게 추가
- **무료**: API 키 불필요 (로컬 AI 모델 사용)
- **오프라인**: 인터넷 없이도 작동

## 🛠️ 구현된 MCP 도구들

### 1. `searchMovies` - 영화 검색 도구
```json
{
  "tool": "searchMovies",
  "parameters": {
    "genre": "로맨스",
    "situation": "우울할 때",
    "type": "인기"
  }
}
```

**지원하는 검색 조건:**
- **장르**: 로맨스, 액션, 코미디, 스릴러, 드라마, SF, 판타지, 호러, 애니메이션, 다큐멘터리
- **상황**: 우울할 때, 친구와 함께, 연인과 함께, 가족과 함께, 힐링
- **타입**: 인기, 개봉예정

### 2. `getMovieInfo` - 영화 정보 조회 도구
```json
{
  "tool": "getMovieInfo",
  "parameters": {
    "title": "인터스텔라"
  }
}
```

## 🔧 시스템 아키텍처

```
사용자 메시지 → MCP 챗봇 서비스 → 도구 호출 결정 → MCP 서버 → 영화 데이터베이스
                    ↓
                Ollama AI 모델 → 자연어 응답 생성
```

## 📋 설정 방법

### 1. Ollama 설치 및 설정
```bash
# Ollama 설치 (OLLAMA_SETUP.md 참조)
curl -fsSL https://ollama.ai/install.sh | sh

# 모델 다운로드
ollama pull llama2

# 서비스 시작
ollama serve
```

### 2. 백엔드 실행
```bash
# Spring Boot 애플리케이션 시작
./mvnw spring-boot:run
```

### 3. 프론트엔드 실행
```bash
cd frontend
npm start
```

## 🎯 사용 예시

### 예시 1: 장르별 영화 추천
```
사용자: "로맨스 영화 추천해줘"

MCP 처리:
1. 도구 호출: searchMovies(genre="로맨스")
2. 결과: 5개 로맨스 영화 발견
3. AI 응답: "로맨스 영화를 찾아드렸어요! 💕 총 5개의 따뜻한 로맨스 영화를 추천해드릴게요..."
```

### 예시 2: 영화 정보 검색
```
사용자: "인터스텔라 영화에 대해 알려줘"

MCP 처리:
1. 도구 호출: getMovieInfo(title="인터스텔라")
2. 결과: 영화 상세 정보 조회
3. AI 응답: "인터스텔라는 정말 멋진 SF 영화예요! 🚀 크리스토퍼 놀란 감독의 작품으로..."
```

### 예시 3: 상황별 추천
```
사용자: "오늘 기분이 우울한데 영화 추천해줘"

MCP 처리:
1. 도구 호출: searchMovies(situation="우울할 때")
2. 결과: 코미디, 드라마 장르 영화 5개 발견
3. AI 응답: "우울할 때는 따뜻한 영화가 최고예요! ☀️ 기분 전환에 도움이 되는 힐링 영화들을 추천해드릴게요!"
```

## 🔍 API 엔드포인트

### 챗봇 API
- `POST /api/chatbot/chat` - 챗봇 대화
- `GET /api/chatbot/suggestions` - 추천 질문 목록

### MCP 도구 API
- `POST /api/mcp/tools/searchMovies` - 영화 검색
- `POST /api/mcp/tools/getMovieInfo` - 영화 정보 조회
- `GET /api/mcp/tools/available` - 사용 가능한 도구 목록

## 💡 장점

### 기존 방식 vs MCP 방식

| 구분 | 기존 (프롬프트 기반) | MCP (도구 기반) |
|------|-------------------|----------------|
| 정확도 | 프롬프트 의존 | 구조화된 도구 호출 |
| 확장성 | 제한적 | 높음 |
| 유지보수 | 어려움 | 쉬움 |
| 데이터 정확성 | 불확실 | 보장됨 |

### MCP의 장점:
1. **정확한 데이터**: 도구를 통한 정확한 데이터베이스 검색
2. **확장 가능**: 새로운 도구 쉽게 추가
3. **유지보수 용이**: 도구별 독립적 관리
4. **무료**: 로컬 AI 모델 사용
5. **오프라인**: 인터넷 없이도 작동

## 🚨 문제 해결

### Ollama 연결 실패
```bash
# Ollama 상태 확인
ollama list

# 서비스 재시작
ollama serve
```

### MCP 도구 호출 실패
1. 백엔드 로그 확인
2. 데이터베이스 연결 상태 확인
3. 도구 파라미터 검증

### 응답이 느린 경우
- 더 작은 모델 사용: `ollama pull llama2:7b`
- 설정에서 모델 변경: `ollama.model: llama2:7b`

## 🎉 완료!

이제 완전히 무료로 MCP 기반 AI 챗봇을 사용할 수 있습니다! 

**주요 특징:**
- ✅ API 키 불필요
- ✅ 오프라인 작동
- ✅ 정확한 영화 데이터
- ✅ 자연스러운 대화
- ✅ 확장 가능한 구조

**사용해보세요:**
```
"로맨스 영화 추천해줘"
"인터스텔라 영화에 대해 알려줘"
"우울할 때 볼 영화 추천해줘"
"인기 있는 영화 추천해줘"
``` 